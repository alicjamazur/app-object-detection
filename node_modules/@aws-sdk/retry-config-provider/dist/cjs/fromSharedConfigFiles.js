"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.fromSharedConfigFiles = exports.ENV_PROFILE = void 0;
var tslib_1 = require("tslib");
var property_provider_1 = require("@aws-sdk/property-provider");
var shared_ini_file_loader_1 = require("@aws-sdk/shared-ini-file-loader");
var DEFAULT_PROFILE = "default";
exports.ENV_PROFILE = "AWS_PROFILE";
exports.fromSharedConfigFiles = function (init, configKey) {
    if (init === void 0) { init = {}; }
    return function () { return tslib_1.__awaiter(void 0, void 0, void 0, function () {
        var _a, loadedConfig, _b, profile, configFile, _c, _d, configValue;
        return tslib_1.__generator(this, function (_e) {
            switch (_e.label) {
                case 0:
                    _a = init.loadedConfig, loadedConfig = _a === void 0 ? shared_ini_file_loader_1.loadSharedConfigFiles(init) : _a, _b = init.profile, profile = _b === void 0 ? process.env[exports.ENV_PROFILE] || DEFAULT_PROFILE : _b;
                    return [4 /*yield*/, loadedConfig];
                case 1:
                    configFile = (_e.sent()).configFile;
                    _c = configFile[profile] || {}, _d = configKey, configValue = _c[_d];
                    if (typeof configValue === "string") {
                        return [2 /*return*/, configValue];
                    }
                    throw new property_provider_1.ProviderError("No " + configKey + " found for profile " + profile + " in SDK configuration files");
            }
        });
    }); };
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZnJvbVNoYXJlZENvbmZpZ0ZpbGVzLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vc3JjL2Zyb21TaGFyZWRDb25maWdGaWxlcy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7O0FBQUEsZ0VBQTJEO0FBQzNELDBFQUl5QztBQUd6QyxJQUFNLGVBQWUsR0FBRyxTQUFTLENBQUM7QUFDckIsUUFBQSxXQUFXLEdBQUcsYUFBYSxDQUFDO0FBZTVCLFFBQUEscUJBQXFCLEdBQUcsVUFBQyxJQUEyQixFQUFFLFNBQWlCO0lBQTlDLHFCQUFBLEVBQUEsU0FBMkI7SUFBMEMsT0FBQTs7Ozs7b0JBQ2pHLEtBQXNHLElBQUksYUFBaEUsRUFBMUMsWUFBWSxtQkFBRyw4Q0FBcUIsQ0FBQyxJQUFJLENBQUMsS0FBQSxFQUFFLEtBQTBELElBQUksUUFBVCxFQUFyRCxPQUFPLG1CQUFHLE9BQU8sQ0FBQyxHQUFHLENBQUMsbUJBQVcsQ0FBQyxJQUFJLGVBQWUsS0FBQSxDQUFVO29CQUU1RixxQkFBTSxZQUFZLEVBQUE7O29CQUFqQyxVQUFVLEdBQUssQ0FBQSxTQUFrQixDQUFBLFdBQXZCO29CQUNtQixLQUFBLFVBQVUsQ0FBQyxPQUFPLENBQUMsSUFBSSxFQUFFLEVBQXRELEtBQUMsU0FBVSxFQUFFLFdBQVcsU0FBQSxDQUErQjtvQkFDL0QsSUFBSSxPQUFPLFdBQVcsS0FBSyxRQUFRLEVBQUU7d0JBQ25DLHNCQUFPLFdBQVcsRUFBQztxQkFDcEI7b0JBRUQsTUFBTSxJQUFJLGlDQUFhLENBQUMsUUFBTSxTQUFTLDJCQUFzQixPQUFPLGdDQUE2QixDQUFDLENBQUM7OztTQUNwRztBQVYwRyxDQVUxRyxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgUHJvdmlkZXJFcnJvciB9IGZyb20gXCJAYXdzLXNkay9wcm9wZXJ0eS1wcm92aWRlclwiO1xuaW1wb3J0IHtcbiAgbG9hZFNoYXJlZENvbmZpZ0ZpbGVzLFxuICBTaGFyZWRDb25maWdGaWxlcyxcbiAgU2hhcmVkQ29uZmlnSW5pdCBhcyBCYXNlU2hhcmVkQ29uZmlnSW5pdCxcbn0gZnJvbSBcIkBhd3Mtc2RrL3NoYXJlZC1pbmktZmlsZS1sb2FkZXJcIjtcbmltcG9ydCB7IFByb3ZpZGVyIH0gZnJvbSBcIkBhd3Mtc2RrL3R5cGVzXCI7XG5cbmNvbnN0IERFRkFVTFRfUFJPRklMRSA9IFwiZGVmYXVsdFwiO1xuZXhwb3J0IGNvbnN0IEVOVl9QUk9GSUxFID0gXCJBV1NfUFJPRklMRVwiO1xuXG5leHBvcnQgaW50ZXJmYWNlIFNoYXJlZENvbmZpZ0luaXQgZXh0ZW5kcyBCYXNlU2hhcmVkQ29uZmlnSW5pdCB7XG4gIC8qKlxuICAgKiBUaGUgY29uZmlndXJhdGlvbiBwcm9maWxlIHRvIHVzZS5cbiAgICovXG4gIHByb2ZpbGU/OiBzdHJpbmc7XG5cbiAgLyoqXG4gICAqIEEgcHJvbWlzZSB0aGF0IHdpbGwgYmUgcmVzb2x2ZWQgd2l0aCBsb2FkZWQgYW5kIHBhcnNlZCBjcmVkZW50aWFscyBmaWxlcy5cbiAgICogVXNlZCB0byBhdm9pZCBsb2FkaW5nIHNoYXJlZCBjb25maWcgZmlsZXMgbXVsdGlwbGUgdGltZXMuXG4gICAqL1xuICBsb2FkZWRDb25maWc/OiBQcm9taXNlPFNoYXJlZENvbmZpZ0ZpbGVzPjtcbn1cblxuZXhwb3J0IGNvbnN0IGZyb21TaGFyZWRDb25maWdGaWxlcyA9IChpbml0OiBTaGFyZWRDb25maWdJbml0ID0ge30sIGNvbmZpZ0tleTogc3RyaW5nKTogUHJvdmlkZXI8c3RyaW5nPiA9PiBhc3luYyAoKSA9PiB7XG4gIGNvbnN0IHsgbG9hZGVkQ29uZmlnID0gbG9hZFNoYXJlZENvbmZpZ0ZpbGVzKGluaXQpLCBwcm9maWxlID0gcHJvY2Vzcy5lbnZbRU5WX1BST0ZJTEVdIHx8IERFRkFVTFRfUFJPRklMRSB9ID0gaW5pdDtcblxuICBjb25zdCB7IGNvbmZpZ0ZpbGUgfSA9IGF3YWl0IGxvYWRlZENvbmZpZztcbiAgY29uc3QgeyBbY29uZmlnS2V5XTogY29uZmlnVmFsdWUgfSA9IGNvbmZpZ0ZpbGVbcHJvZmlsZV0gfHwge307XG4gIGlmICh0eXBlb2YgY29uZmlnVmFsdWUgPT09IFwic3RyaW5nXCIpIHtcbiAgICByZXR1cm4gY29uZmlnVmFsdWU7XG4gIH1cblxuICB0aHJvdyBuZXcgUHJvdmlkZXJFcnJvcihgTm8gJHtjb25maWdLZXl9IGZvdW5kIGZvciBwcm9maWxlICR7cHJvZmlsZX0gaW4gU0RLIGNvbmZpZ3VyYXRpb24gZmlsZXNgKTtcbn07XG4iXX0=